(function(){var o,s,f,t,h,v,c,i,u,n,l,y,a,r,e,p=[].indexOf||function(n){for(var t=0,i=this.length;t<i;t++)if(t in this&&this[t]===n)return t;return-1};window.AN={};window.AN.plot_sensor=function(n,t){var i;return $("#select_chart").val(n),t!=null&&(i=$("#select_sensor"),$("#select_sensor").attr("multiple")==="multiple"?(i.multiselect("destroy"),i.removeAttr("multiple"),i.val(t),i.attr("multiple","multiple"),i.multiselect(s)):i.val(t)),u()};window.AN.plot_building_chart_sensor=function(n,t,i){return $("#select_bldg").val(n),a(null,t,i)};f=!0;t=!1;i=function(){if(f&&!t)return e()===""?history.replaceState(null,null,"?".concat(n())):n()!==e()&&history.pushState(null,null,"?".concat(n())),r()};n=function(){return $("#content select, #content input").serialize()};r=function(){return $("body").css("cursor","wait"),$.getJSON($("#BaseURL").text()+"reports/results/",n()).done(function(n){return $("body").css("cursor","default"),$("#results").empty(),$("#results").html(n.html),$.each(n.objects,function(n,t){var i,r;r=t[0];i=t[1];switch(r){case"plotly":return Plotly.plot(i.renderTo,i.data,i.layout,i.config);case"dashboard":return ANdash.createDashboard(i)}})}).fail(function(n,t,i){var r;return $("body").css("cursor","default"),r=t+", "+i,alert("Error Occurred: "+r)})};v=function(){var t;return t='<script src="'+$("#BaseURL").text()+"reports/embed/?"+n()+'" style="width: 930px" async><\/script>',prompt("Here's the text to embed this report in another page:",t)};l=function(n,t){for(var u,r,i=0,f=n.length;i<f;i++)u=n[i],r=document.getElementById($.trim(u)),t?$(r).show().find("select, input:visible").prop("disabled",!1):$(r).hide().find("select, input").prop("disabled",!0);return t};o=6e5;h=setInterval(r,o);s={minWidth:300,selectedList:3,close:i};u=function(){var t,n,u;return l(["refresh","ctrl_sensor","ctrl_avg","ctrl_avg_export","ctrl_normalize","ctrl_occupied","xy_controls","time_period","download_many"],!1),t=$("#select_chart").find("option:selected"),u=t.data("ctrls").split(","),l(u,!0),clearInterval(h),t.data("timed_refresh")===1&&(h=setInterval(r,o)),f=t.data("auto_recalc")===1,n=$("#select_sensor"),t.data("multi_sensor")===1?n.attr("multiple")!=="multiple"&&(n.off(),n.attr("multiple","multiple"),n.multiselect(s)):n.attr("multiple")==="multiple"&&(n.multiselect("destroy"),n.removeAttr("multiple"),n.off().change(i)),f===!1&&$("#results").empty(),i()};a=function(n,t,i){var r;return r=$("#BaseURL").text()+"chart-sensor-list/"+$("#select_group").val()+"/"+$("#select_bldg").val()+"/",$.ajax({url:r,dataType:"json",async:!1,success:function(n){return $("#select_chart").html(n.charts),$("#select_sensor").html(n.sensors),$("#select_sensor_x").html(n.sensors),$("#select_sensor_y").html(n.sensors),t!=null?window.AN.plot_sensor(t,i):u()}})};y=function(){return $("#select_bldg").load($("#BaseURL").text()+"bldg-list/"+$("#select_group").val()+"/",function(){if(t===!1)return $("#select_bldg").trigger("change")})};$(window).on("popstate",function(){return c(),r()});e=function(){var n,t;return t=window.location.href,n=t.indexOf("?")+1,n>0?t.substr(n):""};c=function(){var i,r,s,u,n,f,o;for(n={},$.each(e().replace(/\+/g,"%20").split("&"),function(){var t,i,r;i=this.split("=");t=decodeURIComponent(i[0]);r=i.length>1?decodeURIComponent(i[1]):null;t in n||(n[t]=[]);n[t].push(r)}),f=function(){var t,i=["select_group","select_bldg","select_chart"];for(t in n)p.call(i,t)<0&&i.push(t);return i}(),t=!0,r=0,s=f.length;r<s;r++)u=f[r],n.hasOwnProperty(u)&&(i=$("[name='"+u+"']"),o=n[u],i.val()!=o&&(i.val(o),i.attr("multiple")==="multiple"&&i.multiselect("refresh"),i.change()));return t=!1,n};$(function(){var s,o,f,e,h,l;for($(document).tooltip(),$("#time_period").buttonset(),$("#start_date").datepicker({dateFormat:"mm/dd/yy"}),f=new Date,$("#start_date").val(f.getMonth()+1+"/"+f.getDate()+"/"+f.getFullYear()),$("#end_date").datepicker({dateFormat:"mm/dd/yy"}),$("#time_period").change(function(){return $("input:radio[name=time_period]:checked").val()!=="custom"?$("#custom_dates").hide().find("select, input").prop("disabled",!0):$("#custom_dates").show().find("select, input").prop("disabled",!1)}),$("#time_period").change(),$("#refresh").button().click(r),$("#get_embed_link").click(v),$("#normalize").button(),$("#show_occupied").button(),$("#div_date").datepicker({dateFormat:"mm/dd/yy"}),$("#download_many").button().click(function(){return window.location.href=$("#BaseURL").text()+"reports/results/?"+n()}),$("#select_group").change(y),$("#select_bldg").change(a),$("#select_chart").change(u),o=["averaging_time","averaging_time_export","normalize","show_occupied","select_sensor","select_sensor_x","select_sensor_y","averaging_time_xy","div_date","time_period"],e=0,h=o.length;e<h;e++)s=o[e],$("#"+s).change(i);return l=c(),t=!0,u(),t=!1,history.replaceState(null,null,"?".concat(n())),i()})}).call(this);
//# sourceMappingURL=bmsapp.min.js.map
